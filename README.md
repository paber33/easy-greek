# 🇬🇷 Easy Greek - Умное изучение греческого языка

Современное веб-приложение для изучения греческого языка с алгоритмом умного повторения SM-2 (Anki-style). Построено на Next.js, TypeScript и TailwindCSS.

## ✨ Основные возможности

### 🎨 Современный UI
- **shadcn/ui компоненты**: Красивые, доступные и кастомизируемые компоненты
- **Темная/светлая тема**: Автоматическое переключение и ручной контроль
- **Адаптивный дизайн**: Идеально работает на всех устройствах
- **Lucide иконки**: Современные, четкие иконки
- **Плавные анимации**: Transitions и hover эффекты
- **Toast уведомления**: Красивые всплывающие уведомления для действий

### 📚 Умный алгоритм повторений (SM-2 / Anki-style)
- **Проверенный алгоритм**: Использует классический SM-2 алгоритм, как в Anki
- **Ease Factor (EF)**: Индивидуальный коэффициент легкости для каждой карточки (начальное значение 2.5)
- **Интервалы повторений**: Автоматически рассчитываются на основе EF и истории ответов
- **4 уровня оценки**: Again (0), Hard (1), Good (2), Easy (3)
- **Шаги изучения**: [1, 10] минут для новых карточек
- **Умная очередь**: Сначала срочные learning/relearning, потом просроченные review, затем новые карточки
- **Обнаружение сложных слов (Leech)**: Автоматическое выявление проблемных карточек после 8+ ошибок

### 🎯 Основные экраны

#### Dashboard (Главная)
- Общая статистика: всего слов, новые, изучаемые, на повторении
- Прогресс за сегодня
- Счетчик streak (дней подряд)
- Быстрый доступ к основным разделам

#### Список слов (`/words`)
- Полная таблица словаря с:
  - Греческое слово и перевод
  - Теги для организации
  - Статус (новая/изучается/повторение/переизучается)
  - Срок повторения
  - Количество повторений и ошибок
  - Процент успеха
  - Стабильность (S) и Сложность (D)
- **Фильтры и поиск**:
  - Поиск по греческому/переводу
  - Фильтр по статусу
  - Фильтр по тегам
  - Сортировка по сроку/алфавиту/повторениям
- Добавление, редактирование, сброс карточек
- Импорт/экспорт CSV

#### Тренировка (`/session`)
- **Умная очередь карточек**:
  - Все просроченные learning/relearning карточки (срочные)
  - До 120 просроченных review карточек (самые просроченные первыми)
  - До 10 новых карточек в день
- Чистый интерфейс карточки: греческое → показать ответ → оценить
- Горячие клавиши: `Space` — показать ответ, `1-4` — оценить
- Индикатор прогресса "n / total"
- Счетчик оставшихся срочных карточек
- Экран завершения с детальной статистикой

#### Журнал и статистика (`/logs`)
- Общие метрики: streak, всего повторений, точность, сессий
- **Canvas график активности** (без внешних библиотек):
  - Просмотр за 7 или 30 дней
  - Stacked bars (правильные/неправильные ответы)
  - Даты и значения
- Таблица истории сессий (последние 30 дней):
  - Повторено, правильно, неправильно
  - Точность с прогресс-баром
  - Новые/изучаемые/повторяемые карточки

## 🧠 Детали алгоритма SM-2 (Anki-style)

### Состояния карточек
- **new**: Новая карточка, еще не изучалась
- **learning**: Карточка в процессе изучения (шаги 1, 10 минут)
- **review**: Карточка на повторении (интервалы в днях)
- **relearning**: Карточка на переизучении после ошибки

### Шаги изучения (Learning Steps)
```typescript
LEARNING_STEPS_MIN = [1, 10] // минуты

// Again (0): вернуться к первому шагу (1 минута)
// Success (1-3): перейти к следующему шагу или graduation
```

### Graduation (Выпуск в review)
```typescript
initialInterval(rating):
  Hard (1): 1 день
  Good (2): 2 дня (по умолчанию)
  Easy (3): 4 дня

ease = 2.5 (начальный Ease Factor)
```

### SM-2 Формула для review карточек
```typescript
// Конвертация rating в q5 (1-5 шкала SM-2)
q5 = rating === 0 ? 1 : rating === 1 ? 3 : rating === 2 ? 4 : 5

// Обновление Ease Factor (EF)
EF = max(1.3, oldEF + (0.1 - (3 - q5) * (0.08 + (3 - q5) * 0.02)))

// Расчет интервала
if (reps === 1): interval = 1
else if (reps === 2): interval = 6
else:
  mod = rating === 1 ? 0.85 : rating === 3 ? 1.15 : 1.0
  interval = round(interval * EF * mod)

// Применение jitter (±15%)
jitter = uniform(0.85, 1.15)
nextDays = max(1, round(interval * jitter))
due = now + nextDays
```

### Обработка ошибок (Again)
```typescript
// В review: переход в relearning
if (review && rating === 0):
  lapses += 1
  status = "relearning"
  reps = 0
  interval = 0
  due = now + LEARNING_STEPS_MIN[0] // 1 минута
  
  // Leech detection
  if (lapses >= 8):
    isLeech = true
```

### Стратегия построения очереди
1. **Все просроченные learning/relearning** (строго срочные, время критично)
2. **До DAILY_REVIEWS (120) review карточек**:
   - Сортировка: насколько просрочены (больше = выше)
   - Вторично: ниже R (сложнее = выше)
3. **До DAILY_NEW (10) новых карточек** (FIFO)

### Leech (трудные слова)
Если `lapses >= 8` и на последних попытках `R < 0.5`:
- Пометить как "leech"
- Заморозить на 3 дня
- Показать в отдельном списке

## 🚀 Начало работы

### Требования
- Node.js 18+
- npm или yarn

### Установка

```bash
# Клонировать репозиторий
git clone <repository-url>
cd easy-greek

# Установить зависимости
npm install

# Запустить dev сервер
npm run dev

# Открыть http://localhost:3000
```

### Production build

```bash
npm run build
npm start
```

## 📁 Структура проекта

```
easy-greek/
├── app/
│   ├── page.tsx              # Dashboard (главная)
│   ├── layout.tsx            # Root layout + навигация
│   ├── globals.css           # Глобальные стили
│   ├── words/
│   │   └── page.tsx          # Список слов
│   ├── session/
│   │   └── page.tsx          # Тренировка
│   └── logs/
│       └── page.tsx          # Статистика и журнал
├── types/
│   └── index.ts              # TypeScript типы
├── lib/
│   ├── srs.ts                # FSRS-lite планировщик
│   ├── queue.ts              # Построение очереди
│   ├── storage.ts            # localStorage CRUD
│   ├── csv.ts                # Импорт/экспорт CSV
│   ├── utils.ts              # Утилиты (даты, clamp и т.д.)
│   └── constants.ts          # Конфигурация
└── README.md
```

## 🎮 Использование

### Добавление слов
1. Перейдите в "Слова"
2. Нажмите "+ Добавить"
3. Введите греческое слово, перевод и теги
4. Карточка будет помечена как "новая"

### Начало сессии
1. Нажмите "Начать сессию" на главной или в списке слов
2. Прочитайте греческое слово
3. Нажмите `Space` или "Показать ответ"
4. Оцените свой ответ:
   - **Again (1)**: Забыл полностью
   - **Hard (2)**: Вспомнил с трудом
   - **Good (3)**: Вспомнил со средним усилием
   - **Easy (4)**: Мгновенно вспомнил
5. Завершите сессию и посмотрите результаты

### Импорт/Экспорт
**Экспорт**: В разделе "Слова" нажмите "📥 Экспорт CSV"

**Формат CSV для импорта**:
```csv
id,greek,translation,tags
1,Γεια σου,Привет,greetings;basics
2,Ευχαριστώ,Спасибо,greetings
```

## ⚙️ Конфигурация

### Параметры по умолчанию
```typescript
DAILY_NEW = 10           // Новых карточек в день
DAILY_REVIEWS = 120      // Повторений в день
LEARNING_STEPS = [1, 10] // Шаги изучения (минуты)
R_TARGET = {
  again: 0.95,  // Короткое повторение
  hard: 0.90,   // Чуть дольше
  good: 0.85,   // Стандарт
  easy: 0.80    // Длинный интервал
}
```

Меньшие значения R_target = более длинные интервалы между повторениями.

## 📊 Seed данные

При первом запуске приложение автоматически загружает **20 греческих слов**:
- **Приветствия**: Καλημέρα, Ευχαριστώ, Παρακαλώ и др.
- **Глаголы**: τρώω, πίνω, είμαι, έχω и др.
- **Еда**: νερό, κρασί, καφές, τυρί и др.
- **Существительные**: σπίτι, οικογένεια, φίλος и др.

### 🎯 Параметры карточек

Каждое слово содержит:

**Основная информация:**
- `greek` - греческое написание
- `translation` - русский перевод
- `tags` - теги для категоризации (например: `["greetings", "verbs"]`)

**Дополнительный контент:**
- `examples` - примеры использования в предложениях
- `pronunciation` - транскрипция произношения
- `notes` - дополнительные заметки и подсказки
- `audioUrl` - ссылка на аудио файл (для будущего использования)
- `imageUrl` - ссылка на изображение (для будущего использования)

**SRS данные:**
- `status` - статус изучения (`new`, `learning`, `review`, `relearning`)
- `ease` - коэффициент легкости (Ease Factor)
- `interval` - интервал повторения в днях
- `reps` - количество повторений
- `lapses` - количество ошибок
- `correct`/`incorrect` - статистика правильных/неправильных ответов
- `isLeech` - пометка "сложной" карточки

### 📝 Пример карточки

```json
{
  "id": "1",
  "greek": "Καλημέρα",
  "translation": "Доброе утро",
  "tags": ["greetings"],
  "examples": [
    "Καλημέρα! Πώς είσαι; - Доброе утро! Как дела?",
    "Καλημέρα κύριε! - Доброе утро, господин!"
  ],
  "pronunciation": "кали-мЭ-ра",
  "notes": "Используется до 12:00. После полудня говорят Καλησπέρα",
  "status": "new",
  "ease": 2.5,
  "interval": 0
}
```

Некоторые карточки предварительно настроены как "review" с различными ease/interval для демонстрации алгоритма.

## 🔧 Технические детали

### Технологии
- **Framework**: Next.js 15 (App Router)
- **Язык**: TypeScript 5
- **Стили**: TailwindCSS 4
- **UI Components**: shadcn/ui (Radix UI + TailwindCSS)
- **Иконки**: Lucide React
- **Уведомления**: Sonner
- **Темы**: next-themes (light/dark режим)
- **Управление состоянием**: React Hooks
- **Хранилище**: localStorage API
- **Графики**: Canvas API (без внешних библиотек)

### Ключевые классы и функции
- `SRSScheduler`: Основная реализация алгоритма
  - `buildQueue()`: Умный выбор карточек
  - `rate()`: Обновление состояния карточки
  - `computeRetrievability()`: Расчет силы памяти
- Pure functions в `lib/utils.ts` для тестирования

### Производительность
- Только клиентская сторона (нет API-вызовов)
- Мгновенное обновление карточек
- Оптимизировано для 1000+ карточек
- Минимальные ре-рендеры благодаря правильным React паттернам

## 🎯 Критерии готовности

✅ Работает в браузере после первого запуска  
✅ Можно начать сессию (новые + просроченные)  
✅ Оценки меняют S/D/due строго по формулам  
✅ После F5 состояние и логи сохраняются  
✅ Импорт/экспорт CSV работает  
✅ Нет линтер ошибок  
✅ TypeScript без `any`  
✅ Фильтры и поиск по словам  
✅ Canvas графики без внешних библиотек  
✅ Роутинг Next.js (`/words`, `/session`, `/logs`)  
✅ Модульная архитектура (types, lib)  

## 🚧 Будущие улучшения

Потенциальные фичи для следующих версий:
- Настройки конфигурации через UI
- MCQ режим (множественный выбор)
- Аудио произношение
- Детальная аналитика и расширенные графики
- Фильтрация по множественным тегам
- Синхронизация с облаком
- Мобильное приложение (React Native)
- Маркетплейс общих колод
- Темная/светлая тема (переключатель)
- Unit-тесты для SRS (Vitest/Jest)
- E2E тесты (Playwright)

## 🤝 Вклад

Вклад приветствуется! Открывайте issues для багов и feature requests, присылайте pull requests.

## 📄 Лицензия

MIT License - используйте свободно для обучения или production.

## 🙏 Благодарности

- Вдохновлено Anki и SuperMemo
- Алгоритм FSRS от Jarrett Ye
- Сообщество изучающих греческий язык

---

**Построено с ❤️ для изучающих языки**

Καλή τύχη! (Удачи!)
