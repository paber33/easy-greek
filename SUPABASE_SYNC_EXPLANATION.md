# üîÑ –û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å Supabase

## üîç –ü—Ä–æ–±–ª–µ–º–∞

**–í–æ–ø—Ä–æ—Å:** –ü–æ—á–µ–º—É —Å–ª–æ–≤–∞ –Ω–µ —Ç—è–Ω—É—Ç—Å—è –∏–∑ Supabase cards?

**–û—Ç–≤–µ—Ç:** –ü–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—ã–ª–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –Ω–∞ —Ä–∞–±–æ—Ç—É **—Ç–æ–ª—å–∫–æ —Å localStorage**, –∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å Supabase –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö, –Ω–æ –Ω–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ.

## üèóÔ∏è –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–ª–∞ —Å–∏—Å—Ç–µ–º–∞ –î–û –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
```typescript
// LocalCardsRepository.list() - –¢–û–õ–¨–ö–û localStorage
async list(profileId: ProfileId): Promise<Card[]> {
  return load(ns(profileId, "cards"), [] as Card[]); // ‚ùå –¢–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
}
```

### 2. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
```typescript
// saveCards() - localStorage + Supabase
export const saveCards = (cards: Card[]): void => {
  localStorage.setItem(keys.cards, JSON.stringify(cards)); // ‚úÖ –õ–æ–∫–∞–ª—å–Ω–æ
  syncService.syncCards(cards).catch(console.error);      // ‚úÖ –í –æ–±–ª–∞–∫–æ
}
```

### 3. –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ Supabase
```typescript
// –¢–æ–ª—å–∫–æ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const handleLoadUserData = async () => {
  await loadAndSaveUserDataFromSupabase() // ‚úÖ –¢–æ–ª—å–∫–æ –ø—Ä–∏ –≤—Ö–æ–¥–µ
}
```

## ‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Å—Ç–∞—Ä–æ–π —Å–∏—Å—Ç–µ–º—ã

1. **–°–ª–æ–≤–∞ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–ª–∏—Å—å** –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. **–°–ª–æ–≤–∞ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–ª–∏—Å—å** –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
3. **–°–ª–æ–≤–∞ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–ª–∏—Å—å** –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
4. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –±—ã–ª–∞ –æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–π** (—Ç–æ–ª—å–∫–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –æ–±–ª–∞–∫–æ)

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π LocalCardsRepository

```typescript
export const LocalCardsRepository: CardsRepository = {
  async list(profileId: ProfileId): Promise<Card[]> {
    // 1. –°–Ω–∞—á–∞–ª–∞ –ø—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ localStorage
    const localCards = load(ns(profileId, "cards"), [] as Card[]);
    
    if (localCards.length > 0) {
      return localCards; // ‚úÖ –ï—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    }
    
    // 2. –ï—Å–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ Supabase
    try {
      const { syncService } = await import('../sync');
      const userData = await syncService.loadUserData();
      
      if (userData && userData.cards.length > 0) {
        // 3. –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ Supabase –≤ localStorage
        save(ns(profileId, "cards"), userData.cards);
        return userData.cards; // ‚úÖ –î–∞–Ω–Ω—ã–µ –∏–∑ –æ–±–ª–∞–∫–∞
      }
    } catch (error) {
      console.log('Failed to load from Supabase:', error);
    }
    
    return []; // ‚úÖ –ü—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ –µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
  }
}
```

## üîÑ –ö–∞–∫ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞

### 1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–£–õ–£–ß–®–ï–ù–û)
```typescript
// LocalCardsRepository.list() - localStorage + Supabase
async list(profileId: ProfileId): Promise<Card[]> {
  // ‚úÖ –°–Ω–∞—á–∞–ª–∞ localStorage
  // ‚úÖ –ï—Å–ª–∏ –Ω–µ—Ç - –∑–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ Supabase
  // ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
}
```

### 2. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (–ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô)
```typescript
// bulkSave() - localStorage + Supabase
async bulkSave(profileId: ProfileId, cards: Card[]): Promise<void> {
  save(ns(profileId, "cards"), cards);        // ‚úÖ –õ–æ–∫–∞–ª—å–Ω–æ
  await syncService.syncCards(cards);         // ‚úÖ –í –æ–±–ª–∞–∫–æ
}
```

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- **–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ:** localStorage ‚Üí Supabase ‚Üí localStorage
- **–ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏:** localStorage ‚Üí Supabase
- **–ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
- **–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–°–ª–æ–≤–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ Supabase** –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏
2. **–°–ª–æ–≤–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è** –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
3. **–°–ª–æ–≤–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è** –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
4. **–°–ª–æ–≤–∞ –¥–æ—Å—Ç—É–ø–Ω—ã** –¥–∞–∂–µ –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ (localStorage)
5. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ Supabase

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Supabase
node test-supabase-sync.js

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Supabase —É—Å–ø–µ—à–Ω–æ
üìä –ù–∞–π–¥–µ–Ω–æ –∫–∞—Ä—Ç–æ—á–µ–∫ –≤ Supabase: 0
‚ö†Ô∏è –í Supabase –Ω–µ—Ç –∫–∞—Ä—Ç–æ—á–µ–∫
```

**–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ!** –ö–∞—Ä—Ç–æ—á–∫–∏ –ø–æ—è–≤—è—Ç—Å—è –≤ Supabase –ø–æ—Å–ª–µ:
1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –ó–∞–≥—Ä—É–∑–∫–∏ —Å–ª–æ–≤ —á–µ—Ä–µ–∑ JSON
3. –ü–µ—Ä–≤–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

## üöÄ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### 1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–ª–æ–≤–∞ —á–µ—Ä–µ–∑ JSON
```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∞–π–ª greek-words-76.json
# –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏: –°–ª–æ–≤–∞ ‚Üí –ó–∞–≥—Ä—É–∑–∏—Ç—å JSON
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
```bash
# –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ª–æ–≤
node test-supabase-sync.js

# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
üìä –ù–∞–π–¥–µ–Ω–æ –∫–∞—Ä—Ç–æ—á–µ–∫ –≤ Supabase: 76
üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å [user-id]: 76 –∫–∞—Ä—Ç–æ—á–µ–∫
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É
- –°–ª–æ–≤–∞ –¥–æ–ª–∂–Ω—ã –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ò–º–ø–æ—Ä—Ç syncService
```typescript
// –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∏–º–ø–æ—Ä—Ç –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
const { syncService } = await import('../sync');
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```typescript
try {
  // –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ Supabase
} catch (error) {
  console.log('Failed to load from Supabase:', error);
  // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç—É —Å localStorage
}
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```typescript
console.log(`Loaded ${userData.cards.length} cards from Supabase for profile ${profileId}`);
```

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞!** –¢–µ–ø–µ—Ä—å —Å–ª–æ–≤–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ Supabase –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏. –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã:

- **localStorage ‚Üí Supabase** (–ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏)
- **Supabase ‚Üí localStorage** (–ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ)

–≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –≤—Å–µ–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è! üéâ
